<!-- ArcGIS API for JavaScript 版本号3.21地图操作首页 -->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<meta name="viewport"
	content="initial-scale=1, maximum-scale=1,user-scalable=no" />

<title>操作地图界面</title>

<link rel="stylesheet" type="text/css"
	href="http://192.168.2.101:8080/arcgis_js_api_v3.21/library/3.21/3.21/esri/css/esri.css" />
<link rel="stylesheet"
	href="http://192.168.2.101:8080/arcgis_js_api_v3.21/library/3.21/3.21/dijit/themes/tundra/tundra.css" />
<link rel="stylesheet" href="/Farmland/css/map/main.css">
<style>
#title {
	background-color: #325C84;
	width: 100%;
}
</style>


<script
	src="http://192.168.2.101:8080/arcgis_js_api_v3.21/library/3.21/3.21/init.js"></script>
	<script src="http://192.168.2.101:8080/Farmland/js/jquery-3.2.1.min.js"></script>
<script type="text/javascript">
	var dojoConfig = {
		locale : 'en',
		isDebug : true,
		async : true,
		packages : [ {
			"name" : "map",
			"location" : "/Farmland/js/map"
		} ]
	};
</script>
<script type="text/javascript">
	var toc = null;
	var map;
	require(
			[ "dojo/parser", "esri/map",
					"esri/layers/ArcGISDynamicMapServiceLayer",
					"esri/layers/FeatureLayer", "esri/InfoTemplate",
					"esri/renderers/SimpleRenderer", "esri/Color",
					"esri/symbols/SimpleFillSymbol",
					"esri/symbols/SimpleLineSymbol",
					"esri/symbols/SimpleMarkerSymbol", "esri/geometry/Extent",
					"esri/SpatialReference",
					"/Farmland/js/map/TocWidget_v3.21.js",
					"../js/map/LayerControl_v3.21.js",
					"../js/map/LeftToolBar_v3.21.js",
					"dijit/layout/BorderContainer", "dijit/layout/ContentPane",
					"dijit/layout/AccordionContainer", "dojo/domReady!" ],
			function(parser, Map, ArcGISDynamicMapServiceLayer, FeatureLayer,
					InfoTemplate, SimpleRenderer, Color, SimpleFillSymbol,
					SimpleLineSymbol, SimpleMarkerSymbol, Extent,
					SpatialReference, TocWidget, LayerControl_v321,
					LeftToolBar_v321) {
				console.log(location.pathname.replace(/\/[^/]+$/, "")
						+ "/js/map");
				parser.parse();

				var extent1 = new esri.geometry.Extent({
					"xmin" : 3.8486722337572604E7,
					"ymin" : 2480415.1499582035,
					"xmax" : 3.858183009056279E7,
					"ymax" : 2527370.5749582024,
					"spatialReference" : {
						"wkid" : 2362
					}
				});
				map = new Map("mapDiv", {
					logo : false,
					extent : extent1
				});

				var layer = new esri.layers.ArcGISDynamicMapServiceLayer(
						"http://192.168.2.144:6080/arcgis/rest/services/Learning/GeoImage/MapServer",
						{
							id : '深圳三调影像'
						});
				map.addLayer(layer);

				map
						.on(
								"load",
								function() {
									map.hideZoomSlider();
									// map.setMapCursor("url(/Farmland/js/map/assets/images/lefttoolbar/enlarge_30px.cur),auto");  
									

									var infoTemplate = new InfoTemplate(
											"Attributes", "${*}");
									var featureLayer = new FeatureLayer(
											"http://192.168.2.144:6080/arcgis/rest/services/Learning/Polygon3/MapServer/0",
											{
												mode : FeatureLayer.MODE_ONDEMAND,
												outFields : [ "*" ],
												infoTemplate : infoTemplate
											});
									/* 					 var renderer = new SimpleRenderer(
									 new SimpleFillSymbol("solid", null, new Color([255, 0, 0, 0.75]) // fuschia lakes!
									 )); */

									var sls = new SimpleLineSymbol(
											SimpleLineSymbol.STYLE_SOLID,
											new Color([ 255, 0, 0 ]), 3);
									var renderer = new SimpleRenderer(sls);

									featureLayer.setRenderer(renderer);
									map.addLayer(featureLayer);
									map.infoWindow.resize(150, 105);
									
									try {
										//  地图控制器
										var ltb = new LeftToolBar_v321({
											id : "leftToolBar",
											map : map
										});

										// 加载图层控制器
										var lc = new LayerControl_v321({
											id : "layerControl",
											map : map
										});
									} catch (err) {
										console.log(" LayerControlJsTest::"
												+ err);
									}
								});
			});

</script>


</head>
<body>
	<div id="mainDiv" data-dojo-type="dijit/layout/BorderContainer"
		data-dojo-props="gutters:true, design:'headline'">

		<div data-dojo-type="dijit/layout/ContentPane"
			data-dojo-props="region:'top'">
			<div id="title">
				<a style="padding: 20px;" href="/"><img
					src="../js/map/assets/images/logo.png" alt="深圳市规划国土发展研究中心" /></a>
			</div>
		</div>
		<div data-dojo-type="dijit/layout/ContentPane"
			data-dojo-props="region:'left'"
			style="background-color: #acb386; width: 40px;">

			<div id="leftToolBar"></div>

			<!-- <div id="toc" data-dojo-attach-point="tocNode" align="left"
				style="width: 90%; filter: alpha(opacity = 90); -moz-opacity: 0.9; opacity: 0.9; background-color: white; overflow: auto; max-height: 400px;">
			</div>
			<br /> 活动图层： <select name="transparencyList" id="transparencyList"
				data-dojo-attach-event="onchange:updateTransparencyLayer">
				<option value="" selected></option>
			</select> &nbsp;<br /> <br /> <input type="button"
				data-dojo-attach-event="onclick:zoomToLayer" value="放大到该图层地理范围"
				style="font-family: Arial, Helvetica, sans-serif; font-size: 10px;">
			<br /> <br /> 改变图层的透明度<br>
			<div data-dojo-type="dijit/form/HorizontalSlider"
				data-dojo-attach-point="slider"
				data-dojo-attach-event="onChange:changeTransparency"
				data-dojo-props="name:'slider',value:100,maximum:100,minimum:0,pageIncrement:100,showButtons:true,intermediateChanges:true,slideDuration:500"
				style="width: 200px; height: 20px;"></div>   -->
		</div>
		<div id="mapDiv" data-dojo-type="dijit/layout/ContentPane"
			data-dojo-props="region:'center'"></div>
		<div id="layerControl" data-dojo-type="dijit/layout/ContentPane"
			data-dojo-props="region:'right', splitter:'true'"
			style="background-color: #acb386; width: 100px;"></div>
		<div data-dojo-type="dijit/layout/ContentPane"
			data-dojo-props="region:'bottom', splitter:'true'"
			style="background-color: #b39b86; height: 50px;">bottom</div>
	</div>
</body>
</html>